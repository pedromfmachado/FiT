<div class="span14">
  <h1>Reservas</h1>

  <h2>
    <% aula = Aula.find(params[:aula_id]) %>
    <%= TipoAula.find(aula.tipo_aula_id).tipo %>
    às <%= aula.inicio.to_s(:time) %>
    (<%= aula.duracao %> minutos)
  </h2>
  <h3>
    <% estudio = Estudio.find(aula.estudio_id) %>
    <%= estudio.nome %> - <%= estudio.lotacao %> lugares
    ( <%= ReservaAula.lugaresDisponiveis(aula.id) %> disponíveis )
  </h3>
  <table class="zebra-striped">
    <tr>
      <th>Nome</th>
      <th>Data</th>
    </tr>

    <% @reservas.each do |reserva| %>
    
      <% if reserva.dia == Date.today %>
        <tr>
          <td><%= User.find(reserva.user_id).nome %></td>
          <td><%= reserva.dia %></td>
        </tr>
      <% end %>
    <% end %>
  </table>

  <div class="actions topSpacing1">
    <% if can?(:create,ReservaAula) %>
      <% if ReservaAula.jaMarcada(current_user.id, aula.id) %>
        <%= link_to 'Cancelar', reserva_aula_path(ReservaAula.getReserva(current_user.id, aula.id, Date.today).id), :action => :destroy, :method => :delete, :class => "btn danger" %>
      <% else %>
        <%= link_to 'Marcar', reserva_aulas_path(:aula_id => aula.id, :user_id => current_user.id, :dia => Date.today), :action => :create, :method => :post , :class => "btn success"%>
      <% end %>
    <% end %>
  </div>

</div>

